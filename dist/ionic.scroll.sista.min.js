!function(e,t){"use strict";e.module("jett.ionic.scroll.sista",["ionic"]).directive("scrollSista",["$document","$timeout","$rootScope","$ionicScrollDelegate",function(a,n,r,o){function i(e,t,a,n){var r;for(n=n||10;e.parentNode&&n--;){if(r=e.parentNode.getAttribute(t),r&&r===a)return e.parentNode;e=e.parentNode}return null}var c=400,l=2*c,s=t.Platform.isAndroid()?!1:!0;return{restrict:"A",link:function(r,c,u){function f(e,a,r){r&&!e.style[t.CSS.TRANSITION_DURATION]&&(e.style[t.CSS.TRANSITION_DURATION]=r,n(function(){e.style[t.CSS.TRANSITION_DURATION]=""},l,!1)),e.style[t.CSS.TRANSFORM]="translateY("+-a+"px)"}function d(){m=0,N=0,p=0}function b(){var e;if(y=q.querySelector('[nav-bar="cached"] .bar-header'),g=q.querySelector('[nav-bar="active"] .bar-header'))switch(A=g.offsetHeight,T=A,M=q.querySelectorAll(".tabs"),M=M[M.length-1],M&&(R=M.offsetHeight,M.parentNode.classList.contains("tabs-top")?(w=!0,T+=R):M.parentNode.classList.contains("tabs-bottom")&&(D=!0)),e=i(c[0],"nav-view","active"),I=e&&e.querySelector(".bar-subheader"),I&&($=I.offsetHeight,T+=$),k=2*T,O=x=C=k,R=R||0,$=$||0,u.scrollSista){case"header":C=A,x=w?A:0;break;case"header-tabs":F=w?R:0,C=w?A+R:A;break;case"tabs-subheader":O=0,F=w?T-A:$,U=w?$:0;break;case"tabs":O=0,C=w?R:0;break;case"subheader":O=0,x=0;break;case"header-subheader":x=w?A:0;break;case"subheader-header":F=$,U=w?$:0,x=w?A:0;break;default:F=w?T-A:$,U=w?$:0}}function h(a,n){var r=Math.max(0,1-a/A);g&&(f(g,a,n),"false"!=u.enableTranslucent&&e.forEach(g.children,function(e){e.style.opacity=r,s&&(e.style[t.CSS.TRANSFORM]="scale("+r+","+r+")")})),y&&f(y,a,n)}function S(e,t){var a,n,r=c[0].style,o=e>F?e-F:0;I&&(n=e>_?e-_:0,f(I,Math.min(C,n),t)),M&&(a=Math.min(x,e>U?e-U:0),D&&(a=-a,r.bottom=Math.max(0,R-e)+"px"),f(M,a,t)),h(Math.min(O,o),t),r.top=Math.max(0,T-e)+"px"}function v(e,a){t.requestAnimationFrame(function(){S(e,a)})}var m,N,p,y,g,A,T,I,$,M,R,k,O,x,C,H=!0,q=a[0].body,E=u.delegateHandle?o.$getByHandle(u.delegateHandle):o,w=(E.getScrollView(),!1),D=!1,F=0,U=0,_=0;r.$on("scroll.refreshComplete",function(){d()}),r.$on("$stateChangeSuccess",function(e,t,a,n,r){H=!0,S(0),g=null,y=null}),r.$parent.$on("$ionicView.afterEnter",function(){d(),n(function(){b(),H=!1},20,!1)}),c.bind("scroll",function(e){if(!H){e=e.originalEvent||e;var t=u.scrollEventInterval?u.scrollEventInterval+"ms":0,a=e.detail.scrollTop;m=a>=0?Math.min(k,Math.max(0,m+a-p)):0,p=a,N!==m&&(N=m,v(m,t))}})}}}])}(angular,ionic);